<mat-card class="panel">
  <mat-toolbar color="primary" class="toolbar">
    <span>Virtual Farm â€” Simulation</span>
    <span class="spacer"></span>
    <button mat-icon-button (click)="runSimulation()" [disabled]="running" aria-label="Run">
      <mat-icon>play_arrow</mat-icon>
    </button>
    <mat-progress-spinner *ngIf="running" diameter="28" mode="indeterminate"></mat-progress-spinner>
  </mat-toolbar>

  <div class="content">
    <div class="controls">
      <mat-form-field appearance="fill">
        <mat-label>Crop type</mat-label>
        <mat-select [(ngModel)]="selectedType">
          <mat-option *ngFor="let t of types" [value]="t">{{t}}</mat-option>
        </mat-select>
      </mat-form-field>

      <mat-form-field appearance="fill">
        <mat-label>Area (ha)</mat-label>
        <input matInput type="number" [(ngModel)]="areaHa" min="0.01" step="0.01">
      </mat-form-field>

      <mat-form-field appearance="fill">
        <mat-label>Days horizon</mat-label>
        <input matInput type="number" [(ngModel)]="days" min="7">
      </mat-form-field>

      <mat-form-field appearance="fill">
        <mat-label>Budget</mat-label>
        <input matInput type="number" [(ngModel)]="budget" min="0">
      </mat-form-field>

      <div class="summary" *ngIf="result">
        <div class="row"><strong>Growth:</strong> {{result.growth_percent}}%</div>
        <div class="row"><strong>Yield:</strong> {{result.expected_yield_kg}} {{result.yield_unit}}</div>
        <div class="row"><strong>Budget:</strong> {{result.budget_breakdown?.total | currency}}</div>
      </div>

      <div *ngIf="error" class="error">{{error}}</div>
    </div>

    <div class="canvas" #canvasContainer></div>
  </div>
</mat-card>